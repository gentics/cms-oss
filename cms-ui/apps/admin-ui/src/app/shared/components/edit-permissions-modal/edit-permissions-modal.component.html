<div class="modal-title">
  <h5>{{ 'modal.edit_perms_title' | gtxI18n:{ entity: permSet.label } }}</h5>
</div>

<div class="modal-content">
  <div class="flex-container">
    <gtx-checkbox
      [(ngModel)]="allPermsGranted"
      (change)="onAllPermsToggle($event)"
      [label]="'group.all_perms'| gtxI18n"
      [disabled]="!hasEditPermissionRight()"
    ></gtx-checkbox>
    <gtx-checkbox
      [(ngModel)]="applyToSubObjects"
      [label]="(permSet.type === AccessControlledType.FOLDER ? 'group.apply_to_subfolders' : 'group.apply_to_subobjects') | gtxI18n"
      [disabled]="!hasEditPermissionRight()"
    ></gtx-checkbox>
    <gtx-checkbox
      [(ngModel)]="applyToSubGroups"
      [label]="'group.apply_to_subgroups'| gtxI18n"
      [disabled]="!hasEditPermissionRight()"
    ></gtx-checkbox>
  </div>

  <div class="row small-up-1 medium-up-2 large-up-4">
    @for (category of permissionCategories; track category) {
      <div class="column gtx-perm-category-block">
        <h6>{{ category.label | gtxI18n }}</h6>
        @if (categorizedPerms[category.id]; as permissions) {
          <div>
            @for (perm of permissions; track perm) {
              <gtx-checkbox
                [(ngModel)]="perm.value"
                (change)="onPermToggle()"
                [label]="perm.label | gtxI18n"
                [disabled]="!perm.editable"
              ></gtx-checkbox>
            }
          </div>
        }
      </div>
    }
  </div>
  @if (permSet.roles) {
    <div class="row small-up-1">
      <div class="column gtx-perm-category-block">
        <h6>{{ 'common.role_plural' | gtxI18n }}</h6>
        @if (permSet.roles.length > 0) {
          <div>
            @for (role of permSet.roles; track role) {
              <gtx-checkbox
                [(ngModel)]="role.value"
                [label]="role.label"
                [disabled]="!role.editable"
              ></gtx-checkbox>
            }
          </div>
        } @else {
          -
        }
      </div>
    </div>
  }
</div>

<div class="modal-footer">
  <gtx-button
    type="primary"
    gtxActionAllowed="group.editPermissions"
    [disabled]="!hasEditPermissionRight()"
    (click)="onSaveClick()"
    >
    {{ 'common.save_button' | gtxI18n }}
  </gtx-button>

  <gtx-button
    type="secondary"
    flat
    (click)="cancelFn()"
    >
    {{ 'common.cancel_button' | gtxI18n }}
  </gtx-button>
</div>
