<!--//
<?
    if ($_REQUEST['submitted']) {
        foreach ($_REQUEST['mandatory'] as $k => $v) {
            if ($v && !$_REQUEST['element'][$k]) {
                $error[$k] = true;
            }
        }
    }
?>
//-->
<?
    if (!$_REQUEST['submitted'] || $error) {
?>

<form action="<? echo $PHP_SELF; ?>" method="post">
<input type="hidden" name="submitted" value="true">
<table border="0" cellpadding="0" cellspacing="0">
<!--//
<?
    if ($error) {
        $errPrefix = <<<EOF
<node errPrefix>
EOF;
        $errPostfix = <<<EOF
<node errPostfix>
EOF;
        $output_error = '<tr><td colspan="2">' . $errPrefix . '<node errMsg>' . $errPostfix . '<br><br></td></tr>';

    }
?>
//-->
<?=$output_error?>
<node container>
<tr>
  <td colspan="2"><br><input type="submit" value="<node submit>" class="form_button"><xnl if ( "<node reset>" != "" )> <input type="reset" value="<node reset>" class="form_button"><xnl end></td></tr>
</table>
</form>

<? } else { ?>
        <node submitted>
<!--//
<?
        foreach ($_REQUEST['label'] as $lkey => $lval) {
            if (is_array($_REQUEST['element'][$lkey])) {
                foreach ($element[$lkey] as $eval) {
                    $values.= $eval."\n";
                }
                $message.= "$lval\n$values\n\n";
            } else {
                $message.= "$lval\n".$_REQUEST['element'][$lkey]."\n\n";
           }
        }
        mail( "<node recipient>", "<node subject>", $message, "From: <node from>");
/*
        $do = 700;
        $action = "insert";
        $form_uid = "<node unique_tag_id>";
        include($DOCUMENT_ROOT . "/portalnode/index.php");
*/
?>
//-->
<?  }  ?>