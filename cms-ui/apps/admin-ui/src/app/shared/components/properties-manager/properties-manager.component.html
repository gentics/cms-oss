<div class="wrapper">
  <gtx-properties-tabs
    class="properties-tabs"
    [items]="finalTabs"
    [selectedTab]="activeTab"
    (selectedTabChange)="setActiveTab($event)"
  ></gtx-properties-tabs>

  <div class="editor-wrapper">
    @if (activeTab && (propertiesMap[activeTab] || editors[activeTab])) {
      @if (editors[activeTab]) {
        <ng-container
          [ngTemplateOutlet]="editors[activeTab]"
          [ngTemplateOutletContext]="{ properties: propertiesMap[activeTab] }"
        ></ng-container>
      } @else {
        @if (propertiesMap[activeTab]?.construct) {
          <div class="tag-editor">
            <div
              class="tag-wrapper"
              [class.disabled]="isDisabled"
              [class.nonActive]="!propertiesMap[activeTab].construct.active"
              [class.tagfillLightEnabled]="(tagfillLightState$ | async)"
              >
              @if (!(tagfillLightState$ | async)) {
                <div class="activate-obj-prop">
                  <gtx-checkbox
                    [checked]="propertiesMap[activeTab].construct.active"
                    [label]="'editor.obj_prop_active_label' | gtxI18n"
                  ></gtx-checkbox>
                </div>
              }
              @if (propertiesMap[activeTab].construct) {
                <gtx-tag-editor-wrapper
                  #tagEditor
                  class="tag-editor-wrapper"
                  [baseUrl]="baseUrl"
                  [nodeId]="nodeId || item.nodeId || item.node?.id"
                  [entityType]="itemType || item.type"
                  [entityId]="item.id"
                  [tagName]="tagNameMap[activeTab]"
                  (change)="forwardTagEditorChange($event)"
                ></gtx-tag-editor-wrapper>
              } @else {
                <span>{{ 'editor.properties_error_loading_tagtype' | gtxI18n }}</span>
              }
            </div>
          </div>
        }
      }
    }
  </div>
</div>
