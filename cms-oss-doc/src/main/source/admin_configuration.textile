h2. Configuration of the CMS

Basically, the CMS can be configured in the following ways:
* Environment variables
* System properties
* Configuration files in YAML format
* Configuration files in JSON format (for the UI)

endprologue.

h3. Backend configuration files

Depending on the environment variables "CONF_PATH":#conf_path and "CONF_FILES":#conf_files, the CMS will read the specified configuration files.
@CONF_FILES@ must be set to a comma separated list of directories and/or files, relative to the path configured via @CONF_PATH@ (which defaults to @conf@ relative to the home directory of the CMS).

Example configuration (with the CMS home directory being @/cms@):

<shell>
export CONF_PATH=conf
export CONF_FILES=basic.yml,features,custom/overrides.yml
</shell>

With the following files:

<shell>
/cms/conf/basic.yml
/cms/conf/custom/overrides.yml
/cms/conf/features/devtools.yml
/cms/conf/features/gis.yml
/cms/conf/features/other.yml
</shell>

The CMS will read the following configuration files (in the given order):
# @/cms/conf/basic.yml@
# @/cms/conf/features/devtools.yml@
# @/cms/conf/features/gis.yml@
# @/cms/conf/features/other.yml@
# @/cms/conf/custom/overrides.yml@

NOTE: With the default value of @CONF_FILES@ (which is empty), the CMS will not read any configuration files (a warning will be logged in that case).

NOTE: Configuration settings from "later" files will overwrite the settings from "earlier" files.

h4. Property substitution

The configuration files support property substitution in string values.

The general format for property substitution is @${key:property}@ where @key@ defines substitution type, and @property@ the property to be substituted:

|_. Key         |_. Description                              |_. Example                           |_. Replacement      |
| base64Encoder | Replace with base64 encoded string         | @${base64Encoder:Hello World}@      | @SGVsbG8gV29ybGQ=@ |
| base64Decoder | Replace with base64 decoded string         | @${base64Decoder:SGVsbG8gV29ybGQ=}@ | @Hello World@      |
| date          | Replace with current date                  | @${date:yyyy-mm-dd}@                | @2023-04-01@       |
| env           | Replace with value of environment variable | @${env:USER}@                       | @node@             |
| sys           | Replace with value of system property      | @${sys:user.name}@                  | @node@             |
| urlEncoder    | Replace with URL encoded string            | @${urlEncoder:path with spaces}@    | @path@<notextile>&#43;</notextile>@with@<notextile>&#43;</notextile>@spaces@ |
| urlDecoder    | Replace with URL decoded string            | @${urlDecoder:path@<notextile>&#43;</notextile>@with@<notextile>&#43;</notextile>@spaces}@    | @path with spaces@ |

NOTE: Since the format for properties contains curly brackets and colons (characters, which are used to format JSON), it is strongly recommended to quote all strings containing properties, which should be substituted.

Example configuration:
<shell filename="conf/*.yml">
maxfilesize: "${env:CMS_MAX_FILESIZE}"
</shell>

h3. UI Configuration files

UI Configuration files must be located in the directory which is defined with the environment variable "UI_CONF_PATH":#ui_conf_path.
Those files will be available over http and will be read by the UI.

h3. Environment variables/System properties

The CMS supports the following environment variables (some settings can also be set over Java System properties or in the CMS configuration):

h4. HTTP_PORT

|_. Description     | Http Port of the CMS                |
|_. Env             | @HTTP_PORT@                         |
|_. System Property | @com.gentics.contentnode.http.port@ |
|_. Configuration   | @server.port@                       |
|_. Default         | 8080                                |

h4. HTTP2

|_. Description     | Use HTTP/2 protocol version         |
|_. Env             | @HTTP2@                             |
|_. System Property | @com.gentics.contentnode.http2@     |
|_. Configuration   | @server.http2@                      |
|_. Default         | false                               |

h4. CONF_PATH

|_. Description     | Path to configuration files           |
|_. Env             | @CONF_PATH@                           |
|_. System Property | @com.gentics.contentnode.config.path@ |
|_. Configuration   | -                                     |
|_. Default         | @conf@                                |

h4. DBFILES_PATH

|_. Description     | Path to binary files                   |
|_. Env             | @DBFILES_PATH@                         |
|_. System Property | @com.gentics.contentnode.dbfiles.path@ |
|_. Configuration   | @config.dbfiles@                       |
|_. Default         | @data/dbfiles@                         |

h4. CONF_FILES

|_. Description     | Comma separated list of configuration files or folders containing configuration files (relative to "CONF_PATH":#conf_path) |
|_. Env             | @CONF_FILES@                                                                                                               |
|_. System Property | @com.gentics.contentnode.config.files@                                                                                     |
|_. Configuration   | -                                                                                                                          |
|_. Default         |                                                                                                                            |

h4. LICENSEKEY

|_. Description     | License Key                                |
|_. Env             | @LICENSEKEY@                               |
|_. System Property | @com.gentics.contentnode.license-key@      |
|_. Configuration   | -                                          |
|_. Default         |                                            |

h4. KEYS_PATH

|_. Description     | Path to keys directory              |
|_. Env             | @KEYS_PATH@                         |
|_. System Property | @com.gentics.contentnode.keys.path@ |
|_. Configuration   | -                                   |
|_. Default         | @keys@                              |

h4. CACHE_CONFIG_PATH

|_. Description     | Path to cache.ccf                           |
|_. Env             | @CACHE_CONFIG_PATH@                         |
|_. System Property | @com.gentics.contentnode.cache.config.path@ |
|_. Configuration   | -                                           |
|_. Default         | ["CONF_PATH":#conf_path]/@cache.ccf@        |

h4. CACHE_PATH

|_. Description     | Path to cache files                  |
|_. Env             | @CACHE_PATH@                         |
|_. System Property | @com.gentics.contentnode.cache.path@ |
|_. Configuration   | -                                    |
|_. Default         | @cache@                              |

h4. LOGS_PATH

|_. Description     | Path to logs                        |
|_. Env             | @LOGS_PATH@                         |
|_. System Property | @com.gentics.contentnode.logs.path@ |
|_. Configuration   | -                                   |
|_. Default         | @logs@                              |

h4. ACCESS_LOG

|_. Description     | Access Log Format, see "Jetty Custom Request Log":https://javadoc.jetty.org/jetty-9/org/eclipse/jetty/server/CustomRequestLog.html |
|_. Env             | @ACCESS_LOG@                                                                                                                       |
|_. System Property | @com.gentics.contentnode.access_log@                                                                                               |
|_. Configuration   | -                                                                                                                                  |
|_. Default         | @%{client}a - %u %t \"%r\" %s %O@                                                                                                  |

h4. PUBLISH_PATH

|_. Description     | Path to statically published files     |
|_. Env             | @PUBLISH_PATH@                         |
|_. System Property | @com.gentics.contentnode.publish.path@ |
|_. Configuration   | -                                      |
|_. Default         | @publish@                              |

h4. GIS_PATH

|_. Description     | Path to statically published GIS files |
|_. Env             | @GIS_PATH@                             |
|_. System Property | @com.gentics.contentnode.gis.path@     |
|_. Configuration   | -                                      |
|_. Default         | ["PUBLISH_PATH":#publish_path]/@gis@   |

h4. PACKAGES_PATH

|_. Description     | Path to the directory containing the devtool packages |
|_. Env             | @PACKAGES_PATH@                                       |
|_. System Property | @com.gentics.contentnode.packages.path@               |
|_. Configuration   | -                                                     |
|_. Default         | @packages@                                            |

h4. CONTENT_PACKAGES_PATH

|_. Description     | Path to the directory containing the content packages |
|_. Env             | @CONTENT_PACKAGES_PATH@                               |
|_. System Property | @com.gentics.contentnode.content_packages.path@       |
|_. Configuration   | -                                                     |
|_. Default         | @content-packages@                                    |

h4. SCHEDULER_COMMANDS_PATH

|_. Description     | Path to the directory containing the scripts, that can be run by the scheduler |
|_. Env             | @SCHEDULER_COMMANDS_PATH@                                                      |
|_. System Property | @com.gentics.contentnode.scheduler_commands.path@                              |
|_. Configuration   | -                                                                              |
|_. Default         | @scheduler-commands@                                                           |

h4. STATIC_SERVE_LIST

|_. Description     | Comma separated list of directories that contain files, which should be served statically over HTTP |
|_. Env             | @STATIC_SERVE_LIST@                                                                                 |
|_. System Property | @com.gentics.contentnode.static_serve_list@                                                         |
|_. Configuration   | -                                                                                                   |
|_. Default         |                                                                                                     |

h4. UI_CONF_PATH

|_. Description     | Path to UI configuration files         |
|_. Env             | @UI_CONF_PATH@                         |
|_. System Property | @com.gentics.contentnode.ui.conf_path@ |
|_. Configuration   | @ui.conf_path@                         |
|_. Default         | @ui-conf@                              |

h4. TMP_PATH

|_. Description     | Path to store temporary files          |
|_. Env             | @TMP_PATH@                             |
|_. System Property | @com.gentics.contentnode.tmp_path@     |
|_. Configuration   | @tmppath@                              |
|_. Default         | System property java.io.tmpdir         |

h4. NODE_USER_PASSWORD

|_. Description     | Initial password for the CMS user 'node'     |
|_. Env             | @NODE_USER_PASSWORD@                         |
|_. System Property | @com.gentics.contentnode.node_user.password@ |
|_. Configuration   | -                                            |
|_. Default         |                                              |

h4. NODE_DB_DRIVER_CLASS

|_. Description     | Name of the JDBC Driver class for accessing the backend DB |
|_. Env             | @NODE_DB_DRIVER_CLASS@                                     |
|_. System Property | @com.gentics.contentnode.db.driverClass@                   |
|_. Configuration   | @db.settings.driverClass@                                  |
|_. Default         | @org.mariadb.jdbc.Driver@                                  |

h4. NODE_DB_HOST

|_. Description     | Hostname of the backend DB        |
|_. Env             | @NODE_DB_HOST@                    |
|_. System Property | @com.gentics.contentnode.db.host@ |
|_. Configuration   | @db.settings.host@                |
|_. Default         | @localhost@                       |

h4. NODE_DB_PORT

|_. Description     | Port of the backend DB            |
|_. Env             | @NODE_DB_PORT@                    |
|_. System Property | @com.gentics.contentnode.db.port@ |
|_. Configuration   | @db.settings.port@                |
|_. Default         | @3306@                            |

h4. NODE_DB_USER

|_. Description     | Username for accessing the backend DB |
|_. Env             | @NODE_DB_USER@                        |
|_. System Property | @com.gentics.contentnode.db.user@     |
|_. Configuration   | @db.settings.user@                    |
|_. Default         |                                       |

h4. NODE_DB_PASSWORD

|_. Description     | Password for accessing the backend DB |
|_. Env             | @NODE_DB_PASSWORD@                    |
|_. System Property | @com.gentics.contentnode.db.password@ |
|_. Configuration   | @db.settings.password@                |
|_. Default         |                                       |

h4. NODE_DB_NAME

|_. Description     | Name of the backend DB            |
|_. Env             | @NODE_DB_NAME@                    |
|_. System Property | @com.gentics.contentnode.db.name@ |
|_. Configuration   | @db.settings.name@                |
|_. Default         | @node_utf8@                       |

h4. NODE_DB_PARAMETERS

|_. Description     | Additional JDBC Parameters for accessing the backend DB |
|_. Env             | @NODE_DB_PARAMETERS@                                    |
|_. System Property | @com.gentics.contentnode.db.parameters@                 |
|_. Configuration   | @db.settings.jdbcparameters@                            |
|_. Default         | @netTimeoutForStreamingResults=900@                     |

h4. NODE_DB_URL

|_. Description     | JDBC Connection URL for accessing the backend DB                                                                                                                         |
|_. Env             | @NODE_DB_URL@                                                                                                                                                            |
|_. System Property | @com.gentics.contentnode.db.url@                                                                                                                                         |
|_. Configuration   | @db.settings.url@                                                                                                                                                        |
|_. Default         | _Will be constructed from ["NODE_DB_HOST":#node_db_host], ["NODE_DB_PORT":#node_db_port], ["NODE_DB_NAME":#node_db_name] and ["NODE_DB_PARAMETERS":#node_db_parameters]_ |

h4. NODE_DB_INIT_TIMEOUT

|_. Description     | Timeout in ms for establishing initial connection to the backen DB, when the CMS is started |
|_. Env             | @NODE_DB_INIT_TIMEOUT@                                                                      |
|_. System Property | @com.gentics.contentnode.db.init_timeout@                                                   |
|_. Configuration   | -                                                                                           |
|_. Default         | @60000@                                                                                     |

h4. ALOHAEDITOR_PATH

|_. Description     | Path to Aloha Editor (used only in development environments) |
|_. Env             | @ALOHAEDITOR_PATH@                                           |
|_. System Property | @com.gentics.contentnode.alohaeditor.path@                   |
|_. Configuration   | -                                                            |
|_. Default         |                                                              |

h4. ALOHAEDITOR_PLUGINS_PATH

|_. Description     | Path to Aloha Editor Plugins (used only in development environments) |
|_. Env             | @ALOHAEDITOR_PLUGINS_PATH@                                           |
|_. System Property | @com.gentics.contentnode.alohaeditor.plugins.path@                   |
|_. Configuration   | -                                                                    |
|_. Default         |                                                                      |

h4. GCNJSAPI_PATH

|_. Description     | Path to Gentics CMS JS API (used only in development environments) |
|_. Env             | @GCNJSAPI_PATH@                                                    |
|_. System Property | @com.gentics.contentnode.gcnjsapi.path@                            |
|_. Configuration   | -                                                                  |
|_. Default         |                                                                    |

