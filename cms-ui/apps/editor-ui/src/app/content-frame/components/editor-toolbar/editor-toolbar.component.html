<div *ngIf="editorState" class="editor-toolbar">
    <div class="element-toolbar">
        <div class="breadcrumb-info">
            <gtx-breadcrumbs
                [routerLinks]="breadcrumbs"
                [multiline]="true"
                [multilineExpanded]="multilineExpanded"
                [class.is-inherited]="nodeInherited"
                [class.not-inherited]="!nodeInherited"
                (linkClick)="changeFocus()"
                (multilineExpandedChange)="expandedChanged($event)"
            >
                <icon *ngIf="nodeInherited" class="iconChannel">input</icon>
            </gtx-breadcrumbs>

            <div class="item-info">
                <div class="title-name" [title]="currentItem?.name | replaceEscapedCharacters">
                    <ng-template [ngIf]="currentItem?.type !== 'node'">
                        <inherited-localized-icon [item]="currentItem" [editorNodeId]="editorNodeId" ></inherited-localized-icon>
                        <span class="item-name">{{ currentItem?.name | replaceEscapedCharacters }}</span>
                    </ng-template>
                </div>

                <div class="item-version" *ngIf="(currentItem?.type === 'page' || currentItem?.type === 'form') && editorState.version">
                    <span *ngIf="editorState.oldVersion">v{{ editorState.oldVersion.number }} <i class="material-icons comparison-icon" [attr.translate]="'no'">compare_arrows</i> v{{ version.number }}</span>
                    <span *ngIf="!editorState.oldVersion">v{{ editorState.version.number }}</span>
                </div>

                <div *ngIf="currentItem?.type === 'form' || (currentItem?.type === 'page' && $any(currentItem)?.contentGroupId)" class="item-language">
                    <div>{{ itemLanguage?.code | i18n }}</div>

                    <div *ngIf="editorState.compareWithId">
                        <i class="material-icons comparison-icon" [attr.translate]="'no'">compare_arrows</i>
                    </div>
                    <div *ngIf="editorState.compareWithId">
                        {{ pageComparisonLanguage?.code | i18n }}
                    </div>
                </div>

                <div class="form-type" *ngIf="currentItem && currentItem.type === 'form'">
                    {{ 'editor.item_type_label' | i18n }}: {{ 'gtxFormGenerator.form_type_' + ((!!currentItem['data']?.type ? currentItem['data']?.type : CMS_FORM_TYPE.GENERIC) | lowercase) | i18n }}
                </div>
            </div>
        </div>

        <div class="toolbar-actions">
            <div class="item-status">
                <item-status-label
                    [item]="currentItem"
                    [nodeLanguages]="activeNodeLanguages"
                    [activeNodeId]="currentNode?.id"
                ></item-status-label>
            </div>

            <gtx-button
                *ngIf="buttons.saveAsCopy"
                class="primary-action"
                size="small"
                flat
                [disabled]="copyDisabled"
                [title]="'editor.content_frame_save_copy_tooltip' | i18n"
                (click)="saveChanges(SaveBehaviour.SAVE_AS_COPY)"
            >
                <icon left>file_copy</icon>
                <span [innerHTML]="'editor.content_frame_save_copy_button' | i18n"></span>
            </gtx-button>

            <gtx-button
                *ngIf="buttons.previewPage"
                class="primary-action"
                flat
                size="small"
                [routerLink]="previewLink"
            >
                <div *ngIf="!editorState.version">
                    <icon left>pageview</icon>
                    <span>{{ 'editor.preview_label' | i18n }}</span>
                </div>
                <div *ngIf="editorState.version">
                    <icon left>update</icon>
                    <span>{{ 'editor.preview_current_version_label' | i18n }}</span>
                </div>
            </gtx-button>

            <gtx-button
                *ngIf="buttons.edit"
                class="primary-action edit-button"
                size="small"
                flat
                (click)="editItem()"
                [title]="'editor.edit_tooltip' | i18n"
            >
                <icon left>edit</icon>
                <span>{{ 'editor.edit_type_button' | i18n:{ _type: currentItem?.type  } }}</span>
            </gtx-button>

            <gtx-button
                *ngIf="buttons.lockedEdit"
                class="primary-action"
                size="small"
                type="secondary"
                flat
                disabled="true"
                [title]="'editor.content_frame_page_locked_tooltip' | i18n"
            >
                <icon left>lock</icon>
                <span>{{ 'editor.edit_type_button' | i18n:{ _type: currentItem?.type  } }}</span>
            </gtx-button>

            <gtx-split-button
                *ngIf="showSave"
                class="primary-action"
                size="small"
                [disabled]="saveDisabled || isSaving"
                [title]="'editor.content_frame_save_changes_tooltip' | i18n"
            >
                <gtx-split-button-primary-action (click)="saveChanges(SaveBehaviour.REGULAR)">
                    <div class="save-button-primary-action">
                        <icon left>save</icon>
                        <span [innerHTML]="'editor.content_frame_save_changes_button' | i18n"></span>
                    </div>
                </gtx-split-button-primary-action>

                <gtx-dropdown-item
                    *ngIf="currentItem?.type === 'folder' && editorState.openPropertiesTab !== ITEM_PROPERTIES_TAB"
                    (click)="saveChanges(SaveBehaviour.APPLY_TO_SUBFOLDERS)"
                >
                    <icon left>save</icon>
                    <span [innerHTML]="'editor.content_frame_save_changes_and_apply_to_subfolders_button' | i18n"></span>
                </gtx-dropdown-item>

                <gtx-dropdown-item
                    *ngIf="editorState.editMode === EditMode.EDIT_PROPERTIES && currentItem?.type === 'page' && editorState.openPropertiesTab !== ITEM_PROPERTIES_TAB"
                    (click)="saveChanges(SaveBehaviour.APPLY_TO_LANGUAGE_VARIANTS)"
                >
                    <icon left>save</icon>
                    <span [innerHTML]="'editor.content_frame_save_changes_and_apply_to_language_variants_button' | i18n"></span>
                </gtx-dropdown-item>
            </gtx-split-button>

            <gtx-dropdown-list *ngIf="currentItem?.type === 'page' || currentItem?.type === 'form'" class="content-frame-context-menu">
                <gtx-dropdown-trigger>
                    <gtx-button icon type="secondary">
                        <icon>more_vert</icon>
                    </gtx-button>
                </gtx-dropdown-trigger>

                <gtx-dropdown-content>
                    <gtx-dropdown-item *ngIf="buttons.editProperties" (click)="editProperties()">
                        <icon left>settings</icon> {{ 'editor.properties_label' | i18n }}
                    </gtx-dropdown-item>

                    <gtx-dropdown-item *ngIf="buttons.editItem" (click)="editItem()">
                        <icon left>edit</icon> {{ 'editor.edit_label' | i18n }}
                    </gtx-dropdown-item>

                    <gtx-dropdown-item *ngIf="buttons.compareSources" (click)="switchToCompareSources()">
                        <icon left>code</icon> {{ 'editor.compare_version_sources_label' | i18n }}
                    </gtx-dropdown-item>

                    <gtx-dropdown-item *ngIf="buttons.compareContents" (click)="switchToCompareContents()">
                        <icon left>pageview</icon> {{ 'editor.compare_version_contents_label' | i18n }}
                    </gtx-dropdown-item>

                    <gtx-dropdown-item *ngIf="buttons.versionHistory" (click)="showPageVersionsModal()">
                        <icon left>history</icon> {{ 'editor.version_history_label' | i18n }}
                    </gtx-dropdown-item>

                    <gtx-dropdown-item *ngIf="buttons.timeManagement" (click)="showTimeManagement()">
                        <icon left>date_range</icon> {{ 'editor.time_management_label' | i18n }}
                    </gtx-dropdown-item>

                    <gtx-dropdown-item
                        *ngIf="!editorState.focusModeEnabled && (currentItem?.type === 'page' || currentItem?.type === 'form')"
                        class="focus-mode-button"
                        (click)="setFocusMode(true)"
                    >
                        <icon left>fullscreen</icon>{{ 'editor.enable_focus_mode_label' | i18n }}
                    </gtx-dropdown-item>

                    <gtx-dropdown-item
                        *ngIf="editorState.focusModeEnabled && (currentItem?.type === 'page' || currentItem?.type === 'form')"
                        class="focus-mode-button"
                        (click)="setFocusMode(false)"
                    >
                        <icon left>fullscreen_exit</icon>{{ 'editor.disable_focus_mode_label' | i18n }}
                    </gtx-dropdown-item>

                    <gtx-dropdown-item *ngIf="inQueue" (click)="approve()" class="success">
                        <icon left>playlist_add_check</icon> {{ 'editor.publish_queue_btn_approve' | i18n }}
                    </gtx-dropdown-item>

                    <gtx-dropdown-item
                        *ngIf="buttons.publish"
                        class="success"
                        (click)="saveChanges(SaveBehaviour.SAVE_AND_PUBLISH)"
                    >
                        <icon left>cloud_upload</icon> {{ 'editor.publish_label' | i18n }}
                    </gtx-dropdown-item>

                    <gtx-dropdown-item
                        *ngIf="buttons.takeOffline"
                        class="alert"
                        (click)="takeItemOffline()"
                    >
                        <icon left>cloud_off</icon> {{ 'editor.take_offline_label' | i18n }}
                    </gtx-dropdown-item>
                </gtx-dropdown-content>
            </gtx-dropdown-list>

            <gtx-button
                class="close-button"
                icon
                type="secondary"
                (click)="closeEditor()"
            >
                <icon>close</icon>
            </gtx-button>
        </div>
    </div>

    <gtx-page-editor-controls
        *ngIf="currentItem?.type === 'page' && editorState?.editMode === EditMode.EDIT"
        class="page-editor-controls"
    ></gtx-page-editor-controls>

    <gtx-progress-bar class="image-loading" [for]="uploadInProgress$"></gtx-progress-bar>
</div>
