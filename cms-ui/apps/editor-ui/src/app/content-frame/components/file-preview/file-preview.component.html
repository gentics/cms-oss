<div class="preview-pane" [ngClass]="file.type || ''">
    @if (file.type === 'file') {
        <div class="file-preview">
            <div class="file-icon" [ngClass]="fileExtension || ''">
                <icon>insert_drive_file</icon>
                @if (fileExtension) {
                    <span
                        class="extension"
                        [ngClass]="'len-' + fileExtension?.length"
                    >{{ fileExtension | uppercase }}</span>
                }
            </div>
            <div class="file-details">
                <div class="name">{{ file.name }}</div>
                <div class="type">{{ file.fileType }}</div>
                <div class="size">{{ file.fileSize | filesize }}</div>
            </div>
        </div>
    }

    @if (file.type === 'image') {
        <div class="image-preview">
            <div class="filename">{{ file.name }}</div>
            <div
                class="thumbnail"
                [class.loading]="loading"
                [class.vector]="imageDimensions == null"
                [style.aspect-ratio]="imageDimensions?.width > 0 ? `${imageDimensions.width}/${imageDimensions.height}`: null"
            >
                <picture class="previewed-image">
                    @for (variant of imageVariants; track variant.url) {
                        <source
                            [srcset]="variant.url"
                            [media]="variant.mediaQuery"
                            [type]="file.fileType"
                        />
                    }
                    <img [src]="imageUrl" alt="" />
                </picture>
            </div>
            <div class="image-details">
                <span class="dimensions">{{ imageDimensions | imagedimensions | gtxI18n }}</span>
                <span class="separator"> - </span>
                <span class="filesize">{{ file.fileSize | filesize }}</span>
            </div>
        </div>
    }

    <div class="author-details">
        @if (file.creator) {
            <div
                class="created"
                [innerHTML]="'editor.file_preview_creator_label' | gtxI18n:{
                    name: file.creator.firstName + ' ' + file.creator.lastName,
                    date: (file.cdate | gtxI18nDate),
                    time: (file.cdate | gtxI18nDate:'time')
                }"
            ></div>
        }
        @if (file.cdate !== file.edate && file.editor) {
            <div
                class="edited"
                [innerHTML]="'editor.file_preview_editor_label' | gtxI18n:{
                    name: file.editor.firstName + ' ' + file.editor.lastName,
                    date: (file.edate | gtxI18nDate),
                    time: (file.edate | gtxI18nDate:'time')
                }"
            ></div>
        }
    </div>

    <div class="actions-container">
        @if (file.type === 'image' && imageDimensions) {
            <div class="actions-row">
                <gtx-button
                    flat
                    data-action="rotate-left"
                    [disabled]="!canEdit"
                    (click)="rotateImage('ccw')"
                >
                    <icon left>rotate_left</icon> {{ 'editor.rotate_image_left_button' | gtxI18n }}
                </gtx-button>

                <gtx-button
                    flat
                    data-action="rotate-right"
                    (click)="rotateImage('cw')"
                    [disabled]="!canEdit"
                >
                    <icon left>rotate_right</icon> {{ 'editor.rotate_image_right_button' | gtxI18n }}
                </gtx-button>
            </div>
        }

        <div class="actions-row">
            @if (file.type === 'image' && imageDimensions) {
                <gtx-button
                    flat
                    data-action="edit-image"
                    (click)="editImage()"
                    [disabled]="!canEdit"
                >
                    <icon left>edit</icon> {{ 'editor.edit_image_button' | gtxI18n }}
                </gtx-button>
            }

            @if (file.type === 'file') {
                <a [href]="downloadUrl" [download]="file.name" target="_blank">
                    <gtx-button flat data-action="download">
                        <icon left>file_download</icon> {{ 'editor.download_file_button' | gtxI18n }}
                    </gtx-button>
                </a>
            }

            @if (canEdit) {
                <div
                    class="action-replace"
                    [overrideSlot]="file.type === 'image' ? 'replaceImageButton' : 'replaceFileButton'"
                >
                    <gtx-progress-bar [active]="loading"></gtx-progress-bar>
                    <gtx-file-picker
                        flat
                        data-action="replace"
                        [overrideSlot]="file.type === 'image' ? 'replaceImageButton' : 'replaceFileButton'"
                        [overrideParams]="{ FOLDERID: file.folderId, NODEID: nodeId }"
                        [accept]="acceptedFiles()"
                        (fileSelect)="replaceFile($event, uploadBar)"
                        (fileSelectReject)="replaceFile($event, uploadBar)"
                    >
                        <icon left>file_upload</icon>
                        <span>{{ ('editor.upload_new_' + file.type + '_button') | gtxI18n }}</span>
                    </gtx-file-picker>

                    <div class="keep-filename">
                        <gtx-checkbox [(ngModel)]="keepFileName" [label]="'editor.keep_filename_label' | gtxI18n"></gtx-checkbox>
                    </div>
                </div>
            }
        </div>
    </div>
</div>
